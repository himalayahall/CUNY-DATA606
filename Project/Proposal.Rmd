---
title: DATA 606 Data Project Proposal
author: "Jawaid Hakim"
date: "`r Sys.Date()`"
output:
  
  html_document:
    
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
  pdf_document: 
    toc: true
    toc_depth: 3
    number_sections: true
boxlinks: true
urlcolor: blue
always_allow_html: true
editor_options: 
  chunk_output_type: console
---

# Load library

```{r error=FALSE, warning=FALSE}
library(tidyverse)
library(assertive)
library(predictrace)
```

### Data Preparation

```{r setup, echo=TRUE, results='hide', warning=FALSE, message=FALSE}
# load data
df <- read_csv(file = "https://raw.githubusercontent.com/himalayahall/CUNY-DATA606/master/Project/resume_callback.csv")
```

Examine data frame.

```{r}
glimpse(df)
```

Reload with new column data types.

```{r}
df <- read_csv(file = "https://raw.githubusercontent.com/himalayahall/CUNY-DATA606/master/Project/resume_callback.csv",
               col_types = cols(
                   
                    job_ad_id = col_character(),
                    
                    job_city = col_factor(),
                    job_industry = col_factor(),
                    job_type = col_factor(),
                    job_ownership = col_factor(),
                    job_req_school = col_factor(),
                    resume_quality = col_factor(),
                    race = col_factor(),
                    gender = col_factor(),

                    job_fed_contractor = col_logical(),
                    job_req_computer = col_logical(),
                    job_req_communication = col_logical(),
                    job_req_education = col_logical(),
                    job_req_organization = col_logical(),
                    job_equal_opp_employer = col_logical(),
                    job_req_any = col_logical(),
                    
                    college_degree = col_logical(),
                    honors = col_logical(),
                    worked_during_school = col_logical(),
                    computer_skills = col_logical(),
                    volunteer = col_logical(),
                    military = col_logical(),
                    employment_holes = col_logical(),
                    has_email_address = col_logical(),
                    received_callback = col_logical(),
                    special_skills = col_logical(),
                    
                    years_experience = col_integer(),
                    years_college = col_integer(),
                     
               ))
glimpse(df)
```

This dataset has only two race categories: `black` and `white`. It suggests that only applicants from these two races participated in this study.

```{r unique-race-types}
unique(df$race)
```

One major hypothesis is that *perceived gender* of applicants might influence the callback rate. We need some way to *guess* the applicant's gender based on their first name.  

We can use the `predictrace` library to guess genders. After guessing, check accuracy of the gender guesser.  

Looks like it guessed all genders correctly. It suggests that, based on the first name of applicant, employers are very likely to guess the gender.

```{r}
gender_guess <- predict_gender(df$firstname) # guess gender: male or female
gender_guess <- gender_guess %>%     # make factors same as gender in dataset
                    mutate(likely_gender = ifelse(likely_gender == 'male', 'm', 'f'))
df['gender_guessed'] = as.factor(gender_guess$likely_gender)
glimpse(df)
```


Second major hypothesis is that *perceived race* of applicants might influence the callback rate. We need some way to *guess* the applicant's race based on their first name. 

We will again use `predictrace`. Race prediction fails to predict in about `2003` observations containing 11 unique names. 

```{r}
race_guess <- predict_race(df$firstname) # guess gender: male or female
no_race_guess <- race_guess %>% 
                    filter(is.na(likely_race))
unique(no_race_guess$match_name)
```

All 11 appear to be African American names, which itself is an interesting observation on racial bias. Luckily for us, we can safely categorize all 11 *black* race.

```{r}
df['race_guessed'] = race_guess$likely_race
df$race_guessed <- ifelse(is.na(df$race_guessed), 'black', df$race_guessed)
glimpse(df)
```


```{r}
tidyjson::lef
```

### Research question

**You should phrase your research question in a way that matches up with the scope of inference your dataset allows for.**

1. All other factors being equal does the perceived **gender** of applicants have a meaningful impact on the callback rate?
1. All other factors being equal does the perceived **race** of applicants have a meaningful impact on the callback rate?

### Cases

**What are the cases, and how many are there?**

Each case represents a randomly generated application. There are 4870 cases.

### Data collection

Researchers randomly generated realistic resumes to send to job postings in Boston and Chicago. They then randomly assigned a *first name* to the resume that would communicate the race and gender of the application. The first names chosen for the study were selected so that the names would predominantly be recognized as belonging to black or white individuals. 

The dataset is available on [OpenIntro](https://www.openintro.org/data/index.php?data=resume). 

### Type of study

**What type of study is this (observational/experiment)?**

This was an **experiment** conducted over several months during 2001 and 2002.

### Data Source

**If you collected the data, state self-collected. If not, provide a citation/link.**

[OpenIntro](https://www.openintro.org/data/index.php?data=resume). 

### Response Variable

**What is the response variable, and what type is it (numerical/categorical)?**

The response variable is the **callback** rate and it is numerical.

### Explanatory Variable(s)

In this experiment the key explanatory variables are **gender** and **race** of the applicants and will be used to frame the EDA.

### Relevant summary statistics

**Provide summary statistics for each the variables. Also include appropriate visualizations related to your research question (e.g. scatter plot, boxplots, etc). This step requires the use of R, hence a code chunk is provided below. Insert more code chunks as needed.**

```{r}
df %>% 
    filter(college_degree == TRUE) %>%
    group_by(gender) %>%
    summarise(n = n()) %>%
    mutate(freq = n / sum(n))
```

